{"version":3,"file":"182.embed-bundle.js","mappings":"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","sources":["webpack://nbsv/./node_modules/@aics/simularium-viewer/es/simularium/FrontEndError.js","webpack://nbsv/./node_modules/@aics/simularium-viewer/es/simularium/types.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/construct.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack://nbsv/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://nbsv/./node_modules/@aics/simularium-viewer/es/visGeometry/workers/visDataWorker.js","webpack://nbsv/./node_modules/@aics/simularium-viewer/es/simularium/VisDataParse.js"],"sourcesContent":["import _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _wrapNativeSuper from \"@babel/runtime/helpers/wrapNativeSuper\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nexport var ErrorLevel;\n\n(function (ErrorLevel) {\n  ErrorLevel[\"ERROR\"] = \"error\";\n  ErrorLevel[\"INFO\"] = \"info\";\n  ErrorLevel[\"WARNING\"] = \"warning\";\n})(ErrorLevel || (ErrorLevel = {}));\n\nexport var FrontEndError = /*#__PURE__*/function (_Error) {\n  _inherits(FrontEndError, _Error);\n\n  var _super = _createSuper(FrontEndError);\n\n  function FrontEndError(message) {\n    var _this;\n\n    var level = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ErrorLevel.ERROR;\n    var htmlData = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n\n    _classCallCheck(this, FrontEndError);\n\n    for (var _len = arguments.length, params = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n      params[_key - 3] = arguments[_key];\n    }\n\n    // Pass remaining arguments (including vendor specific ones) to parent constructor\n    _this = _super.call.apply(_super, [this].concat(params));\n\n    _defineProperty(_assertThisInitialized(_this), \"htmlData\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"level\", void 0);\n\n    _this.name = \"FrontEndError\";\n    _this.message = message;\n    _this.htmlData = htmlData;\n    _this.level = level;\n    return _this;\n  }\n\n  return _createClass(FrontEndError);\n}( /*#__PURE__*/_wrapNativeSuper(Error));","// TODO: see proposed new NetMessage data type\n//       Remove msgType and fileName from this data structure\n//       Then this data structure appears as a payload of the NetMessage\n// TODO: see proposed new NetMessage data type\n//       Remove msgType and connId from this data structure.\n//       Then this data structure appears as a payload of the NetMessage\n// This should always point to the latest version\nexport var FILE_STATUS_SUCCESS = \"success\";\nexport var FILE_STATUS_FAIL = \"fail\";\n// IMPORTANT: Order of this array needs to perfectly match the incoming data.\nexport var AGENT_OBJECT_KEYS = [// TODO: convert \"vis-type\" to visType at parse time\n\"vis-type\", \"instanceId\", \"type\", \"x\", \"y\", \"z\", \"xrot\", \"yrot\", \"zrot\", \"cr\", \"nSubPoints\"];\n/**\n * Parse Agents from Net Data\n * */","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct.bind();\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n  return _construct.apply(null, arguments);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeFunction from \"./isNativeFunction.js\";\nimport construct from \"./construct.js\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n      _cache.set(Class, Wrapper);\n    }\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return assertThisInitialized(self);\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","import { parseVisDataMessage } from \"../../simularium/VisDataParse\";\nself.addEventListener(\"message\", function (e) {\n  var visDataMsg = e.data;\n\n  var _parseVisDataMessage = parseVisDataMessage(visDataMsg),\n      frameDataArray = _parseVisDataMessage.frameDataArray,\n      parsedAgentDataArray = _parseVisDataMessage.parsedAgentDataArray;\n\n  postMessage({\n    frameDataArray: frameDataArray,\n    parsedAgentDataArray: parsedAgentDataArray\n  });\n}, false);","import { AGENT_OBJECT_KEYS } from \"./types\";\nimport { FrontEndError, ErrorLevel } from \"./FrontEndError\";\n\n/**\n *   Parses a stream of data sent from the backend\n *\n *   To minimize bandwidth, traits/objects are not packed\n *   1-1; what arrives is an array of float values\n *\n *   For instance for:\n *   entity = (\n *        trait1 : 4,\n *        trait2 : 5,\n *        trait3 : 6,\n *    ) ...\n *\n *   what arrives will be:\n *       [...,4,5,6,...]\n *\n *   The traits are assumed to be variable in length,\n *   and the alorithm to decode them needs to the reverse\n *   of the algorithm that packed them on the backend\n *\n *   This is more convuluted than sending the JSON objects themselves,\n *   however these frames arrive multiple times per second. Even a naive\n *   packing reduces the packet size by ~50%, reducing how much needs to\n *   paid for network bandwith (and improving the quality & responsiveness\n *   of the application, since network latency is a major bottle-neck)\n * */\nfunction parseVisDataMessage(visDataMsg) {\n  var parsedAgentDataArray = [];\n  var frameDataArray = [];\n  visDataMsg.bundleData.forEach(function (frame) {\n    var visData = frame.data;\n    var parsedAgentData = [];\n    var nSubPointsIndex = AGENT_OBJECT_KEYS.findIndex(function (ele) {\n      return ele === \"nSubPoints\";\n    });\n\n    var parseOneAgent = function parseOneAgent(agentArray) {\n      return agentArray.reduce(function (agentData, cur, i) {\n        var key;\n\n        if (AGENT_OBJECT_KEYS[i]) {\n          key = AGENT_OBJECT_KEYS[i];\n          agentData[key] = cur;\n        } else if (i < agentArray.length + agentData.nSubPoints) {\n          agentData.subpoints.push(cur);\n        }\n\n        return agentData;\n      }, {\n        subpoints: []\n      });\n    };\n\n    var _loop = function _loop() {\n      var nSubPoints = visData[nSubPointsIndex];\n      var chunkLength = AGENT_OBJECT_KEYS.length + nSubPoints; // each array length is variable based on how many subpoints the agent has\n\n      if (visData.length < chunkLength) {\n        var attemptedMapping = AGENT_OBJECT_KEYS.map(function (name, index) {\n          return \"\".concat(name, \": \").concat(visData[index], \"<br />\");\n        }); // will be caught by controller.changeFile(...).catch()\n\n        throw new FrontEndError(\"Your data is malformed, there are too few entries.\", ErrorLevel.ERROR, \"Example attempt to parse your data: <pre>\".concat(attemptedMapping.join(\"\"), \"</pre>\"));\n      }\n\n      var agentSubSetArray = visData.splice(0, chunkLength); // cut off the array of 1 agent data from front of the array;\n\n      if (agentSubSetArray.length < AGENT_OBJECT_KEYS.length) {\n        var _attemptedMapping = AGENT_OBJECT_KEYS.map(function (name, index) {\n          return \"\".concat(name, \": \").concat(agentSubSetArray[index], \"<br />\");\n        }); // will be caught by controller.changeFile(...).catch()\n\n\n        throw new FrontEndError(\"Your data is malformed, there are less entries than expected for this agent. \", ErrorLevel.ERROR, \"Example attempt to parse your data: <pre>\".concat(_attemptedMapping.join(\"\"), \"</pre>\"));\n      }\n\n      var agent = parseOneAgent(agentSubSetArray);\n      parsedAgentData.push(agent);\n    };\n\n    while (visData.length) {\n      _loop();\n    }\n\n    var frameData = {\n      time: frame.time,\n      frameNumber: frame.frameNumber\n    };\n    parsedAgentDataArray.push(parsedAgentData);\n    frameDataArray.push(frameData);\n  });\n  return {\n    parsedAgentDataArray: parsedAgentDataArray,\n    frameDataArray: frameDataArray\n  };\n}\n\nexport { parseVisDataMessage };"],"names":["ErrorLevel","AGENT_OBJECT_KEYS","_typeof","obj","Symbol","iterator","constructor","prototype","_toPropertyKey","arg","key","input","hint","prim","toPrimitive","undefined","res","call","TypeError","String","_assertThisInitialized","self","ReferenceError","_setPrototypeOf","o","p","Object","setPrototypeOf","bind","__proto__","_getPrototypeOf","getPrototypeOf","_construct","Parent","args","Class","Reflect","construct","sham","Proxy","Boolean","valueOf","e","a","push","apply","instance","Function","arguments","_wrapNativeSuper","_cache","Map","fn","toString","indexOf","has","get","set","Wrapper","this","create","value","enumerable","writable","configurable","_defineProperty","defineProperty","FrontEndError","_Error","subClass","superClass","_inherits","Constructor","Derived","hasNativeReflectConstruct","_super","result","Super","NewTarget","_possibleConstructorReturn","message","_this","level","length","ERROR","htmlData","_classCallCheck","_len","params","Array","_key","concat","name","Error","addEventListener","_parseVisDataMessage","visDataMsg","parsedAgentDataArray","frameDataArray","bundleData","forEach","frame","visData","data","parsedAgentData","nSubPointsIndex","findIndex","ele","_loop","nSubPoints","chunkLength","attemptedMapping","map","index","join","agentSubSetArray","splice","_attemptedMapping","agentArray","agent","reduce","agentData","cur","i","subpoints","frameData","time","frameNumber","parseVisDataMessage","postMessage"],"sourceRoot":""}